# memo

abc *abc* **abc** ***abc***

## bootloader

- システムパーティションはアーキテクチャによって名前が異なる

| arch         | file name        |
| :----------- | :--------------- |
| intel 32bit  | bootia32.efi     |
| 86_64        | bootx64.efi      |
| aarch32      | bootarm.efi      |
| aarch64      | bootaa64.efi     |
| riscv 32bit  | bootriscv32.efi  |
| riscv 64bit  | bootriscv64.efi  |
| riscv 128bit | bootriscv128.efi |

- 外部記憶装置を特定のフォルダにマウントすると通常のファイルシステムのように扱う事ができる(中身をlsコマンドなどを使って見る事ができる)

macでのマウント例

```sh
# mount
MOUNTED_DISK=$(hdiutil attach -imagekey diskimage-class=CRawDiskImage -nomount ./disk.img)
mount -t msdos $MOUNTED_DISK mnt

# unmount
hdiutil detach $MOUNTED_DISK
```

- ABI

rustcを使っている限りはABIの規約を守るのはコンパイラの役割
アセンブリを使う場合はプログラマがABIの規約を守る必要がある

x86_64向けのABIではSystem V AMD64が一般的
aarch64向けを作る場合はABIの違いを考慮する必要がありそう

- uefi-rsクレートのAPI移行

について [詳しく書かれたドキュメント](https://github.com/rust-osdev/uefi-rs/blob/13c1c2be2b17edd73a9565d89431a9266273f8a8/docs/funcs_migration.md?plain=1#L50)

- `rm`しようとするとresource busyとなる場合

1. マウントされたままかを確認

```sh
diskutil list
# or
mount
```

2. マウントされていた場合は解除する

```sh
umount /path/to/mount_point
# or
diskutil eject /path/to/mount_point
```

- ESP

EFI System Partitionの略
通常はブートローダなどが置かれる

---

# uefi-rs aarch64

```sh
qemu-system-aarch64 \
	-nodefaults \
	-device virtio-rng-pci \
	-boot menu=on,splash-time=0 \
	-fw_cfg name=opt/org.tianocore/X-Cpuhp-Bugcheck-Override,string=yes \
	-machine virt \
	-cpu cortex-a72 \
	-device virtio-gpu-pci \
	-drive if=pflash,format=raw,readonly=on,file=target/ovmf/aarch64/code.fd \
	-drive if=pflash,format=raw,readonly=off,file=/var/folders/hy/cv8qx4mn6vs6csg4jh5mml140000gn/T/.tmpFLDhad/ovmf_vars \
	-drive format=raw,file=fat:rw:target/aarch64-unknown-uefi/debug/esp \
	-drive format=raw,file=/var/folders/hy/cv8qx4mn6vs6csg4jh5mml140000gn/T/.tmpFLDhad/test_disk.fat.img \
	-serial pipe:/var/folders/hy/cv8qx4mn6vs6csg4jh5mml140000gn/T/.tmpFLDhad/serial \
	-qmp pipe:/var/folders/hy/cv8qx4mn6vs6csg4jh5mml140000gn/T/.tmpFLDhad/qemu-monitor \
	-nic user,model=e1000,net=192.168.17.0/24,tftp=uefi-test-runner/tftp/,bootfile=fake-boot-file
```

# uefi-rs x86

```sh
qemu-system-aarch64 \
	-nodefaults \
	-device virtio-rng-pci \
	-boot menu=on,splash-time=0 \
	-fw_cfg name=opt/org.tianocore/X-Cpuhp-Bugcheck-Override,string=yes \
	-machine virt -cpu cortex-a72 \
	-device virtio-gpu-pci \
	-drive if=pflash,format=raw,readonly=on,file=target/ovmf/aarch64/code.fd \
	-drive if=pflash,format=raw,readonly=off,file=/var/folders/hy/cv8qx4mn6vs6csg4jh5mml140000gn/T/.tmpFLDhad/ovmf_vars \
	-drive format=raw,file=fat:rw:target/aarch64-unknown-uefi/debug/esp \
	-drive format=raw,file=/var/folders/hy/cv8qx4mn6vs6csg4jh5mml140000gn/T/.tmpFLDhad/test_disk.fat.img \
	-serial pipe:/var/folders/hy/cv8qx4mn6vs6csg4jh5mml140000gn/T/.tmpFLDhad/serial \
	-qmp pipe:/var/folders/hy/cv8qx4mn6vs6csg4jh5mml140000gn/T/.tmpFLDhad/qemu-monitor \
	-nic user,model=e1000,net=192.168.17.0/24,tftp=uefi-test-runner/tftp/,bootfile=fake-boot-file
```

# oso aarch64

```sh
qemu-system-aarch64 \
	-machine virt \
	-cpu cortex-a72 \
	-device virtio-gpu-pci \
	-drive if=pflash,format=raw,readonly=on,file=/tmp/aarch64/code.fd \
	-drive if=pflash,format=raw,readonly=off,file=/Users/a/Downloads/QwQ/oso/target/xtask/ovmf_vars \
	-drive file=/Users/a/Downloads/QwQ/oso/target/xtask/disk.img,format=raw,if=none,id=hd0 \
	-device virtio-blk-device,drive=hd0 \
	-boot menu=on,splash-time=0
```

# oso x86

```sh
qemu-system-x86_64 \
	-machine q35 \
	-smp 4 \
	-vga std \
	-drive if=pflash,format=raw,readonly=on,file=/tmp/x64/code.fd \
	-drive if=pflash,format=raw,readonly=off,file=/Users/a/Downloads/QwQ/oso/target/xtask/ovmf_vars \
	-drive file=/Users/a/Downloads/QwQ/oso/target/xtask/disk.img,format=raw,if=none,id=hd0 \
	-device virtio-blk-pci,drive=hd0 \
	-boot menu=on,splash-time=0
```

# memo

```rust
ElfHeaderIdent {
	file_class: Bit64,
	endianness: Little,
	elf_version: ElfVersion(1),
	target_os_abi: SysV,
	abi_version: AbiVersion(0),
}
```

```sh
target/oso_kernel.elf:  file format elf64-littleaarch64
architecture: aarch64
start address: 0x0000000040010120

Program Header:
    PHDR off    0x0000000000000040 vaddr 0x0000000040000040 paddr 0x0000000040000040 align 2**3
         filesz 0x00000000000000e0 memsz 0x00000000000000e0 flags r--
    LOAD off    0x0000000000000000 vaddr 0x0000000040000000 paddr 0x0000000040000000 align 2**16
         filesz 0x0000000000000120 memsz 0x0000000000000120 flags r--
    LOAD off    0x0000000000000120 vaddr 0x0000000040010120 paddr 0x0000000040010120 align 2**16
         filesz 0x0000000000000010 memsz 0x0000000000000010 flags r-x
   STACK off    0x0000000000000000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**64
         filesz 0x0000000000000000 memsz 0x0000000000000000 flags rw-

Dynamic Section:

Sections:
Idx Name           Size     VMA              Type
  0                00000000 0000000000000000
  1 .text          00000010 0000000040010120 TEXT
  2 .debug_abbrev  00006b5a 0000000000000000 DEBUG
  3 .debug_info    000cac42 0000000000000000 DEBUG
  4 .debug_aranges 00016370 0000000000000000 DEBUG
  5 .debug_str     000bb598 0000000000000000 DEBUG
  6 .comment       000000a1 0000000000000000
  7 .debug_frame   0002b320 0000000000000000 DEBUG
  8 .debug_line    00068531 0000000000000000 DEBUG
  9 .debug_loc     00003139 0000000000000000 DEBUG
 10 .debug_ranges  000418b0 0000000000000000 DEBUG
 11 .symtab        00002fb8 0000000000000000
 12 .shstrtab      00000090 0000000000000000
 13 .strtab        00000c0f 0000000000000000

SYMBOL TABLE:
0000000000000000 l    df *ABS*  0000000000000000 5qzsft9x0i4s6lg4arlufu3dy
0000000040010120 l       .text  0000000000000000 $x
0000000000000000 l       .debug_abbrev  0000000000000000 $d
0000000000000000 l       .debug_info    0000000000000000 $d
0000000000000000 l       .debug_aranges 0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000000 l       .debug_frame   0000000000000000 $d
0000000000000000 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 4doeqh1k3z35f9d92ig0whkcm
000000000000008a l       .debug_abbrev  0000000000000000 $d
00000000000000f8 l       .debug_info    0000000000000000 $d
0000000000000030 l       .debug_aranges 0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000038 l       .debug_frame   0000000000000000 $d
0000000000000052 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 4iui1st2dru1luena21zbis5h
0000000000000000 l       .debug_loc     0000000000000000 $d
0000000000000192 l       .debug_abbrev  0000000000000000 $d
0000000000000647 l       .debug_info    0000000000000000 $d
0000000000000060 l       .debug_aranges 0000000000000000 $d
0000000000000000 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000070 l       .debug_frame   0000000000000000 $d
00000000000000d2 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 1x5z9gs6hfmgqhe89qumsbka8
0000000000000362 l       .debug_abbrev  0000000000000000 $d
0000000000001f55 l       .debug_info    0000000000000000 $d
00000000000002e0 l       .debug_aranges 0000000000000000 $d
0000000000000f80 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000528 l       .debug_frame   0000000000000000 $d
0000000000000af2 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 3piwoi3doaba5ormzuuq6268u
00000000000004bb l       .debug_abbrev  0000000000000000 $d
0000000000002673 l       .debug_info    0000000000000000 $d
0000000000000370 l       .debug_aranges 0000000000000000 $d
0000000000000fe0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
00000000000005e0 l       .debug_frame   0000000000000000 $d
0000000000000c5b l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 4ut6lafrkuv3v4ggiimpbw6e2
00000000000005df l       .debug_abbrev  0000000000000000 $d
0000000000002942 l       .debug_info    0000000000000000 $d
00000000000003c0 l       .debug_aranges 0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000638 l       .debug_frame   0000000000000000 $d
0000000000000d6b l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 6btmonriiclqzbkkdcjcmu366
00000000000006ea l       .debug_abbrev  0000000000000000 $d
0000000000002b70 l       .debug_info    0000000000000000 $d
00000000000003f0 l       .debug_aranges 0000000000000000 $d
0000000000001010 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000670 l       .debug_frame   0000000000000000 $d
0000000000000e16 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 7gh6v82bjba2l1i7opnk1xnja
0000000000000049 l       .debug_loc     0000000000000000 $d
0000000000000870 l       .debug_abbrev  0000000000000000 $d
00000000000031f3 l       .debug_info    0000000000000000 $d
0000000000000450 l       .debug_aranges 0000000000000000 $d
0000000000001060 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000708 l       .debug_frame   0000000000000000 $d
0000000000000f89 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 5b1td0ze969y2nwd3mhask3cj
0000000000000a1a l       .debug_abbrev  0000000000000000 $d
0000000000003ea2 l       .debug_info    0000000000000000 $d
0000000000000530 l       .debug_aranges 0000000000000000 $d
00000000000013b0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000880 l       .debug_frame   0000000000000000 $d
00000000000014ed l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 6gmquzwxrmp6i67bmwyv7mksk
0000000000000b72 l       .debug_abbrev  0000000000000000 $d
0000000000004347 l       .debug_info    0000000000000000 $d
00000000000005a0 l       .debug_aranges 0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000938 l       .debug_frame   0000000000000000 $d
0000000000001a21 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 09m2rhwhvj72wmaxhv42kqzbm
0000000000000bdf l       .debug_abbrev  0000000000000000 $d
0000000000004403 l       .debug_info    0000000000000000 $d
00000000000005d0 l       .debug_aranges 0000000000000000 $d
0000000000001470 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000970 l       .debug_frame   0000000000000000 $d
0000000000001aca l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 6shdkdnws868sgoxu8w7hr7tv
0000000000000cd6 l       .debug_abbrev  0000000000000000 $d
000000000000461f l       .debug_info    0000000000000000 $d
0000000000000620 l       .debug_aranges 0000000000000000 $d
0000000000001510 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
00000000000009e8 l       .debug_frame   0000000000000000 $d
0000000000001d90 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 2rbhxkws67oc4sutogctr92l9
0000000000000e19 l       .debug_abbrev  0000000000000000 $d
0000000000004de1 l       .debug_info    0000000000000000 $d
00000000000006a0 l       .debug_aranges 0000000000000000 $d
00000000000018f0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000ac0 l       .debug_frame   0000000000000000 $d
0000000000002472 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 148mcjq51qg1ytjz0a0qe487m
0000000000000f50 l       .debug_abbrev  0000000000000000 $d
000000000000543c l       .debug_info    0000000000000000 $d
0000000000000740 l       .debug_aranges 0000000000000000 $d
0000000000001ae0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000bd8 l       .debug_frame   0000000000000000 $d
00000000000026fc l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 1pc52ttz12n2s2snh7kykr6mc
000000000000101a l       .debug_abbrev  0000000000000000 $d
00000000000055eb l       .debug_info    0000000000000000 $d
0000000000000790 l       .debug_aranges 0000000000000000 $d
0000000000001b20 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000c50 l       .debug_frame   0000000000000000 $d
0000000000002797 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 8jaqtk6znu3s9zxo7hugjool4
00000000000010c7 l       .debug_abbrev  0000000000000000 $d
0000000000005abd l       .debug_info    0000000000000000 $d
00000000000008e0 l       .debug_aranges 0000000000000000 $d
0000000000001c60 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000ec8 l       .debug_frame   0000000000000000 $d
00000000000029f8 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 9uwvo1ewk7o5c1jvf3yucsthz
0000000000001117 l       .debug_abbrev  0000000000000000 $d
0000000000005b3c l       .debug_info    0000000000000000 $d
0000000000000920 l       .debug_aranges 0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000002b3e l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 a1awqr6ejyolpte2plnpyfulf
0000000000001184 l       .debug_abbrev  0000000000000000 $d
0000000000005bf6 l       .debug_info    0000000000000000 $d
0000000000000950 l       .debug_aranges 0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000f18 l       .debug_frame   0000000000000000 $d
0000000000002b7e l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 5zyskl1cvjinmait8fu2jhrqi
0000000000001292 l       .debug_abbrev  0000000000000000 $d
000000000000616d l       .debug_info    0000000000000000 $d
0000000000000980 l       .debug_aranges 0000000000000000 $d
0000000000001c90 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000f50 l       .debug_frame   0000000000000000 $d
0000000000002c35 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 94scohitl4au79wndqh8hlpju
00000000000013a0 l       .debug_abbrev  0000000000000000 $d
000000000000676e l       .debug_info    0000000000000000 $d
00000000000009c0 l       .debug_aranges 0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000fa8 l       .debug_frame   0000000000000000 $d
0000000000002cf7 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 agqs6ucgzo2pawf00llbsczd2
00000000000014a5 l       .debug_abbrev  0000000000000000 $d
0000000000006ce8 l       .debug_info    0000000000000000 $d
00000000000009f0 l       .debug_aranges 0000000000000000 $d
0000000000001cc0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000000fe0 l       .debug_frame   0000000000000000 $d
0000000000002da2 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 amcem6fj34rv0vd4jaqfjz6cn
00000000000014e9 l       .debug_abbrev  0000000000000000 $d
0000000000006d57 l       .debug_info    0000000000000000 $d
0000000000000a30 l       .debug_aranges 0000000000000000 $d
0000000000001cf0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000001030 l       .debug_frame   0000000000000000 $d
0000000000002e7d l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 cs4q8qsqojfrkbvg3vdntghzh
000000000000158d l       .debug_abbrev  0000000000000000 $d
0000000000006fbf l       .debug_info    0000000000000000 $d
0000000000000ae0 l       .debug_aranges 0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000001168 l       .debug_frame   0000000000000000 $d
0000000000002fa8 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.00
00000000000015e2 l       .debug_abbrev  0000000000000000 $d
0000000000007051 l       .debug_info    0000000000000000 $d
0000000000000b10 l       .debug_aranges 0000000000000000 $d
0000000000001d90 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
00000000000011a0 l       .debug_frame   0000000000000000 $d
00000000000030d3 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.03
00000000000000db l       .debug_loc     0000000000000000 $d
00000000000017bc l       .debug_abbrev  0000000000000000 $d
000000000000d2ff l       .debug_info    0000000000000000 $d
0000000000001280 l       .debug_aranges 0000000000000000 $d
0000000000004f20 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000002058 l       .debug_frame   0000000000000000 $d
0000000000007eee l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.02
0000000000000b58 l       .debug_loc     0000000000000000 $d
0000000000001a9c l       .debug_abbrev  0000000000000000 $d
000000000001449b l       .debug_info    0000000000000000 $d
0000000000001ef0 l       .debug_aranges 0000000000000000 $d
0000000000006850 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
00000000000038c8 l       .debug_frame   0000000000000000 $d
000000000000ab7e l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.04
0000000000000f5b l       .debug_loc     0000000000000000 $d
0000000000001d6a l       .debug_abbrev  0000000000000000 $d
000000000001cf2c l       .debug_info    0000000000000000 $d
0000000000002da0 l       .debug_aranges 0000000000000000 $d
0000000000008cd0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
00000000000055b8 l       .debug_frame   0000000000000000 $d
000000000000dc2c l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.05
0000000000001021 l       .debug_loc     0000000000000000 $d
00000000000020c2 l       .debug_abbrev  0000000000000000 $d
0000000000026385 l       .debug_info    0000000000000000 $d
0000000000003a60 l       .debug_aranges 0000000000000000 $d
000000000000a3b0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000006e60 l       .debug_frame   0000000000000000 $d
0000000000010ef7 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.06
000000000000140e l       .debug_loc     0000000000000000 $d
00000000000024a2 l       .debug_abbrev  0000000000000000 $d
000000000002b968 l       .debug_info    0000000000000000 $d
0000000000004260 l       .debug_aranges 0000000000000000 $d
000000000000c470 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000007d98 l       .debug_frame   0000000000000000 $d
0000000000014536 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.07
0000000000002828 l       .debug_abbrev  0000000000000000 $d
0000000000032ae2 l       .debug_info    0000000000000000 $d
0000000000005050 l       .debug_aranges 0000000000000000 $d
000000000000e740 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000009928 l       .debug_frame   0000000000000000 $d
0000000000017cda l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.01
0000000000002bb6 l       .debug_abbrev  0000000000000000 $d
000000000003aa01 l       .debug_info    0000000000000000 $d
0000000000005a50 l       .debug_aranges 0000000000000000 $d
0000000000011170 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
000000000000ac58 l       .debug_frame   0000000000000000 $d
000000000001b003 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.08
0000000000001654 l       .debug_loc     0000000000000000 $d
0000000000002e11 l       .debug_abbrev  0000000000000000 $d
00000000000410a4 l       .debug_info    0000000000000000 $d
0000000000006460 l       .debug_aranges 0000000000000000 $d
00000000000150f0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
000000000000bfd0 l       .debug_frame   0000000000000000 $d
000000000001f5c7 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.09
000000000000169d l       .debug_loc     0000000000000000 $d
00000000000031b1 l       .debug_abbrev  0000000000000000 $d
0000000000048eab l       .debug_info    0000000000000000 $d
00000000000071f0 l       .debug_aranges 0000000000000000 $d
00000000000175b0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
000000000000dab0 l       .debug_frame   0000000000000000 $d
0000000000022c15 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.10
0000000000001a97 l       .debug_loc     0000000000000000 $d
0000000000003567 l       .debug_abbrev  0000000000000000 $d
000000000004f55b l       .debug_info    0000000000000000 $d
0000000000007c90 l       .debug_aranges 0000000000000000 $d
0000000000019380 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
000000000000eee8 l       .debug_frame   0000000000000000 $d
0000000000025f56 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.11
0000000000001ca4 l       .debug_loc     0000000000000000 $d
0000000000003879 l       .debug_abbrev  0000000000000000 $d
0000000000056fc5 l       .debug_info    0000000000000000 $d
0000000000008350 l       .debug_aranges 0000000000000000 $d
000000000001b2a0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
000000000000fa78 l       .debug_frame   0000000000000000 $d
000000000002986a l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.12
00000000000022a1 l       .debug_loc     0000000000000000 $d
0000000000003bc3 l       .debug_abbrev  0000000000000000 $d
00000000000614b9 l       .debug_info    0000000000000000 $d
00000000000092b0 l       .debug_aranges 0000000000000000 $d
000000000001c870 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
00000000000118a8 l       .debug_frame   0000000000000000 $d
000000000002cf14 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.13
00000000000023c6 l       .debug_loc     0000000000000000 $d
0000000000003faa l       .debug_abbrev  0000000000000000 $d
0000000000069911 l       .debug_info    0000000000000000 $d
000000000000a110 l       .debug_aranges 0000000000000000 $d
000000000001ec90 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000013420 l       .debug_frame   0000000000000000 $d
000000000003043b l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.14
000000000000269a l       .debug_loc     0000000000000000 $d
0000000000004383 l       .debug_abbrev  0000000000000000 $d
0000000000071a14 l       .debug_info    0000000000000000 $d
000000000000ad10 l       .debug_aranges 0000000000000000 $d
0000000000020940 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000014ae8 l       .debug_frame   0000000000000000 $d
0000000000033936 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 core.1484ab736b87836-cgu.15
00000000000046a7 l       .debug_abbrev  0000000000000000 $d
000000000007c673 l       .debug_info    0000000000000000 $d
000000000000ba80 l       .debug_aranges 0000000000000000 $d
0000000000022050 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000016558 l       .debug_frame   0000000000000000 $d
0000000000036cf6 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.00
00000000000049c7 l       .debug_abbrev  0000000000000000 $d
0000000000080afd l       .debug_info    0000000000000000 $d
000000000000bf30 l       .debug_aranges 0000000000000000 $d
00000000000236f0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000016e10 l       .debug_frame   0000000000000000 $d
0000000000039e74 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.01
0000000000004c5f l       .debug_abbrev  0000000000000000 $d
0000000000085c53 l       .debug_info    0000000000000000 $d
000000000000c390 l       .debug_aranges 0000000000000000 $d
0000000000024c60 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
00000000000176a8 l       .debug_frame   0000000000000000 $d
000000000003cc2e l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.02
0000000000002bbc l       .debug_loc     0000000000000000 $d
0000000000004de5 l       .debug_abbrev  0000000000000000 $d
000000000008953e l       .debug_info    0000000000000000 $d
000000000000c830 l       .debug_aranges 0000000000000000 $d
0000000000028540 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000017fa0 l       .debug_frame   0000000000000000 $d
000000000003ef38 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.03
0000000000005021 l       .debug_abbrev  0000000000000000 $d
000000000008c33a l       .debug_info    0000000000000000 $d
000000000000d020 l       .debug_aranges 0000000000000000 $d
00000000000299c0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000018f48 l       .debug_frame   0000000000000000 $d
00000000000416bc l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.04
0000000000005203 l       .debug_abbrev  0000000000000000 $d
000000000008f1dc l       .debug_info    0000000000000000 $d
000000000000d5e0 l       .debug_aranges 0000000000000000 $d
000000000002acc0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000019aa0 l       .debug_frame   0000000000000000 $d
0000000000044656 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.05
00000000000053df l       .debug_abbrev  0000000000000000 $d
000000000009391f l       .debug_info    0000000000000000 $d
000000000000e0f0 l       .debug_aranges 0000000000000000 $d
000000000002cbb0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
000000000001b090 l       .debug_frame   0000000000000000 $d
0000000000047384 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.06
0000000000005633 l       .debug_abbrev  0000000000000000 $d
000000000009da28 l       .debug_info    0000000000000000 $d
000000000000ff00 l       .debug_aranges 0000000000000000 $d
000000000002eb80 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
000000000001ec88 l       .debug_frame   0000000000000000 $d
000000000004be12 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.07
0000000000002e05 l       .debug_loc     0000000000000000 $d
0000000000005780 l       .debug_abbrev  0000000000000000 $d
00000000000a1682 l       .debug_info    0000000000000000 $d
00000000000107b0 l       .debug_aranges 0000000000000000 $d
000000000002fd20 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
000000000001fdc0 l       .debug_frame   0000000000000000 $d
000000000004e705 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.08
00000000000059c0 l       .debug_abbrev  0000000000000000 $d
00000000000a7364 l       .debug_info    0000000000000000 $d
00000000000113b0 l       .debug_aranges 0000000000000000 $d
0000000000030e60 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000021588 l       .debug_frame   0000000000000000 $d
0000000000051cc6 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.09
0000000000005c27 l       .debug_abbrev  0000000000000000 $d
00000000000aa5e9 l       .debug_info    0000000000000000 $d
00000000000118c0 l       .debug_aranges 0000000000000000 $d
0000000000032480 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000021f58 l       .debug_frame   0000000000000000 $d
000000000005411a l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.10
0000000000002f27 l       .debug_loc     0000000000000000 $d
0000000000005e36 l       .debug_abbrev  0000000000000000 $d
00000000000ae53e l       .debug_info    0000000000000000 $d
0000000000011f20 l       .debug_aranges 0000000000000000 $d
0000000000034ce0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000022bf0 l       .debug_frame   0000000000000000 $d
0000000000056a2c l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.11
0000000000002f6f l       .debug_loc     0000000000000000 $d
000000000000606f l       .debug_abbrev  0000000000000000 $d
00000000000ba93a l       .debug_info    0000000000000000 $d
0000000000014860 l       .debug_aranges 0000000000000000 $d
0000000000037610 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000027e48 l       .debug_frame   0000000000000000 $d
000000000005c3fc l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.12
00000000000062ce l       .debug_abbrev  0000000000000000 $d
00000000000bf9f2 l       .debug_info    0000000000000000 $d
0000000000015010 l       .debug_aranges 0000000000000000 $d
0000000000039f80 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
0000000000028d78 l       .debug_frame   0000000000000000 $d
000000000005edc6 l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.13
000000000000304a l       .debug_loc     0000000000000000 $d
0000000000006553 l       .debug_abbrev  0000000000000000 $d
00000000000c281c l       .debug_info    0000000000000000 $d
0000000000015370 l       .debug_aranges 0000000000000000 $d
000000000003c570 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
00000000000293b0 l       .debug_frame   0000000000000000 $d
000000000006132f l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.14
00000000000030dc l       .debug_loc     0000000000000000 $d
000000000000676b l       .debug_abbrev  0000000000000000 $d
00000000000c4c3d l       .debug_info    0000000000000000 $d
0000000000015620 l       .debug_aranges 0000000000000000 $d
000000000003e100 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
00000000000298d8 l       .debug_frame   0000000000000000 $d
00000000000633df l       .debug_line    0000000000000000 $d
0000000000000000 l    df *ABS*  0000000000000000 compiler_builtins.15f5ba5bd6448812-cgu.15
00000000000069b3 l       .debug_abbrev  0000000000000000 $d
00000000000c81fa l       .debug_info    0000000000000000 $d
0000000000016050 l       .debug_aranges 0000000000000000 $d
000000000003f6f0 l       .debug_ranges  0000000000000000 $d
0000000000035827 l       .debug_str     0000000000000000 $d
0000000000000000 l       .comment       0000000000000000 $d
000000000002ad08 l       .debug_frame   0000000000000000 $d
00000000000663cb l       .debug_line    0000000000000000 $d
0000000040010120 g     F .text  0000000000000010 kernel_main
```

---

e: "0x1500000000", link: "0x1", info: "0x0", section_align: "0x6c8a00000000", entry_size: "Oxcac4200 000000 3 3 SectionHeader & name: "0x0", ty: "0x0", flags: "0x1" , address: "0x0", offset: "0x1000000
21", size:
"0x0", link: "Ox0", info: "Oxd18cc", section_align:
"Ox16370", entry_size: "0x0" }

4 SectionHeader & name: "Ox1", ty: "0x0", flags: "0x3000000000", address: "0x3000000001", offset: "0x0", size: "0xe7c3c00000000", link: "0xbb59800000000", info: "0x0", section_align: "0x100000000", entry_size "Ox100000000" 3

5 SectionHeader & name: "0x3b00000000", ty: "0x1", flags: "0x30", address: , offset: 00000044" 3

6 SectionHeader & name: 000000", offset: "0x0", size: "0x800000000", link: "0x0", info: "0x5100000000", section align: "0x1" , entry_size: "0x0" 3

7 SectionHeader & name: "0x1ce59800000000", ty: "0x0", flags: "0x68531", addre ss: "0x0", offset: "0x1", size: "0x0" , link: "0x10000005d", info: "0x0", section_align: "0x0", entry-size: "0x236ac9" }

8 SectionHeader & name: "0x3139", ty: "0x0", flags: "Ox100000000", address: "0x0 ", offset: "0x6800000000", size: "0x1", link: "0x0", info: "0x239c0200000000", section_align: "0x418 b000000000", entry_size: "0x0" 3

9 SectionHeader € name: "Ox100000000", ty: "Ox0", flags: "Ox0", add "0x200000076", offset: "0x0", size: "0x0", link: "0x27b4b8", info: x1fc0000000d", entry_size: "Ox2fb8", ', section_align: "0 "0x8" 3

10 SectionHeader & name: "0x18", ty: "Ox?e", flags: "0x3", addres s: "0x0", offset: "0x27e47000000000", size: "0x9000000000", link: "0x0", info: "0x100000000", sectio n_align: "0x0", entry_size: "0x8800000000"

Sections:

| Idx | Name           | Size     | VMA              | Type  |
| :-- | :------------- | :------- | :--------------- | :---- |
| 0   | none           | 00000000 | 0000000000000000 | none  |
| 1   | .text          | 00000010 | 0000000040010120 | TEXT  |
| 2   | .debug_abbrev  | 00006b5a | 0000000000000000 | DEBUG |
| 3   | .debug_info    | 000cac42 | 0000000000000000 | DEBUG |
| 4   | .debug_aranges | 00016370 | 0000000000000000 | DEBUG |
| 5   | .debug_str     | 000bb598 | 0000000000000000 | DEBUG |
| 6   | .comment       | 000000a1 | 0000000000000000 |       |
| 7   | .debug_frame   | 0002b320 | 0000000000000000 | DEBUG |
| 8   | .debug_line    | 00068531 | 0000000000000000 | DEBUG |
| 9   | .debug_loc     | 00003139 | 0000000000000000 | DEBUG |
| 10  | .debug_ranges  | 000418b0 | 0000000000000000 | DEBUG |
| 11  | .symtab        | 00002fb8 | 0000000000000000 |       |
| 12  | .shstrtab      | 00000090 | 0000000000000000 |       |
| 13  | .strtab        | 00000c0f | 0000000000000000 |       |

# exit boot services

```rust
unsafe fn get_memory_map_and_exit_boot_services(buf: &mut [u8]) -> Result<MemoryMapMeta> {
    let bt = boot_services_raw_panicking();
    let bt = unsafe { bt.as_ref() };
    let memory_map = get_memory_map(buf)?;
    unsafe { (bt.exit_boot_services)(image_handle().as_ptr(), memory_map.map_key.0) }
        .to_result_with_val(|| memory_map)
}

pub unsafe fn exit_boot_services(custom_memory_type: Option<MemoryType>) -> MemoryMapOwned {
    let memory_type = custom_memory_type.unwrap_or(MemoryType::LOADER_DATA);
    crate::helpers::exit();
    let mut buf = MemoryMapBackingMemory::new(memory_type).expect("Failed to allocate memory");
    let mut status = Status::ABORTED;
    for _ in 0..2 {
        match unsafe { get_memory_map_and_exit_boot_services(buf.as_mut_slice()) } {
            Ok(memory_map) => {
                return MemoryMapOwned::from_initialized_mem(buf, memory_map);
            }
            Err(err) => {
                status = err.status()
            }
        }
    }
    runtime::reset(ResetType::COLD, status, None);
}

#[derive(Debug)]
#[allow(clippy::len_without_is_empty)] // this type is never empty
pub(crate) struct MemoryMapBackingMemory(NonNull<[u8]>);

impl MemoryMapBackingMemory {
    /// Constructs a new [`MemoryMapBackingMemory`].
    ///
    /// # Parameters
    /// - `memory_type`: The memory type for the memory map allocation.
    ///   Typically, [`MemoryType::LOADER_DATA`] for regular UEFI applications.
    pub(crate) fn new(memory_type: MemoryType) -> crate::Result<Self> {
        let memory_map_meta = boot::memory_map_size();
        let len = Self::safe_allocation_size_hint(memory_map_meta);
        let ptr = boot::allocate_pool(memory_type, len)?.as_ptr();

        // Should be fine as UEFI always has  allocations with a guaranteed
        // alignment of 8 bytes.
        assert_eq!(ptr.align_offset(align_of::<MemoryDescriptor>()), 0);

        // If this panics, the UEFI implementation is broken.
        assert_eq!(memory_map_meta.map_size % memory_map_meta.desc_size, 0);

        unsafe { Ok(Self::from_raw(ptr, len)) }
    }

    unsafe fn from_raw(ptr: *mut u8, len: usize) -> Self {
        assert_eq!(ptr.align_offset(align_of::<MemoryDescriptor>()), 0);

        let ptr = NonNull::new(ptr).expect("UEFI should never return a null ptr. An error should have been reflected via an Err earlier.");
        let slice = NonNull::slice_from_raw_parts(ptr, len);

        Self(slice)
    }
```

# result of `readelf -h target/oso_kernel.elf`

```sh
ELF Header:
  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00
  Class:                             ELF64
  Data:                              2's complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              EXEC (Executable file)
  Machine:                           AArch64
  Version:                           0x1
  Entry point address:               0x40010120
  Start of program headers:          64 (bytes into file)
  Start of section headers:          2656688 (bytes into file)
  Flags:                             0x0
  Size of this header:               64 (bytes)
  Size of program headers:           56 (bytes)
  Number of program headers:         4
  Size of section headers:           64 (bytes)
  Number of section headers:         14
  Section header string table index: 12
```

> [!note]
> elf header
> class: bit64
> endian: little
> elf version: 1
> abi: sysv
> abi version: 0
> ty: executable
> machine: 183
> version: 1
> entry: 0x40010120
> program_header_offset: 64,
> section_header_offset: 0x2889B0
> flags: 0
> elf header size: 64
> program header entry size: 56
> program header count: 4
> section header entry size: 64
> section header count: 14
> section header index of section name string table: 12

# result of `readelf -l target/oso_kernel.elf`

```sh
Elf file type is EXEC (Executable file)
Entry point 0x40010120
There are 4 program headers, starting at offset 64

Program Headers:
  Type           Offset             VirtAddr           PhysAddr
                 FileSiz            MemSiz              Flags  Align
  PHDR           0x0000000000000040 0x00000000_4000_0040 0x0000000040000040
                 0x00000000000000e0 0x00000000000000e0  R      0x8
  LOAD           0x0000000000000000 0x00000000_4000_0000 0x00000000_4000_0000
                 0x0000000000000120 0x000000000000_0120  R      0x1_0000
  LOAD           0x0000000000000120 0x00000000_4001_0120 0x00000000_4001_0120
                 0x0000000000000010 0x0000000000000010  R E    0x10000
  GNU_STACK      0x0000000000000000 0x0000000000000000 0x0000000000000000
                 0x0000000000000000 0x0000000000000000  RW     0x0

 Section to Segment mapping:
  Segment Sections...
   00
   01
   02     .text
   03
```

# result of `❯ readelf --hex-dump=.text target/oso_kernel.elf`

```sh
❯ readelf --hex-dump=.text target/oso_kernel.elf

Hex dump of section '.text':
  0x40010120 ff4300d1 01000014 5f2003d5 ffffff17 .C......_ ......
```

```sh
0x40010120:  d10043ff  sub      sp, sp, #0x10
0x40010124:  14000001  b        #0x40010128
0x40010128:  d503205f  wfe
0x4001012c:  17ffffff  b        #0x40010128
```

# searching debugging options

of lldb

- set debugged file by cli argument

```sh
--file <filename>     Tells the debugger to use the file <filename> as the program to be debugged.
-f <value>            Alias for --file
```

- auto execute lldb command on startup

```sh
--source-before-file <file>
                     Tells the debugger to read in and execute the lldb commands in the given file, before any file has been loaded.
--source-on-crash <file>
                     When in batch mode, tells the debugger to source this file of lldb commands if the target crashes.
--source-quietly     Tells the debugger not to echo commands while sourcing files or one-line commands provided on the command line.
--source <file>      Tells the debugger to read in and execute the lldb commands in the given file, after any file has been loaded.
-S <value>           Alias for --source-before-file
-s <value>           Alias for --source
```

github actions are free in public repository
